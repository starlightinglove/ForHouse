# 淘宝双十一领喵币辅助

标签（空格分隔）： Android

---

> 原文地址：[淘宝双十一领喵币辅助](https://www.jianshu.com/p/c1cb5a140a00)

## 领喵币
今年淘宝双十一之前有个盖楼的活动，每天可以领喵币去升级自己的等级，但是自己手动去点的话还是挺费时间的，大概每天有30个任务，每个任务需要滑动屏幕12秒钟，对于只想领币的同学来说还是略微有点麻烦，这种无脑重复劳动用脚本帮我们做做最合适不过了。

其实在我看到这个活动的时候我就想了想要不要做一个辅助出来，但是其实有一开始并没有参与这个活动，而且觉得写写这个真的太简单了，没什么必要浪费时间。但是过了几天，在群里有朋友发链接，程序员用脚本领喵币，觉得很厉害；这就很厉害吗...好吧，那我晚上回去也写一个吧，明天来帮你们领喵币。纯粹为了装X...

## 实现方法
没什么好说的了，肯定是用Android辅助来做了，关于Android辅助可以看[Android辅助功能基本操作](https://www.jianshu.com/p/8935bde74c50)，这里就不再介绍了。

### 控件获取
那首先获取一下领取红包这个界面有哪些控件吧，然后一获取就发现这东西找不到里面的具体的控件，只能看到一个父布局，其实用过淘宝的同学都知道淘宝很多界面内容是用网页实现的，所以我们在这里没法根据控件去实现领喵币

![截屏2019-12-09下午1.58.42.png-1229.7kB](http://static.zybuluo.com/Tyhj/3wzeuvosm5ifu70jiyag9rp6/%E6%88%AA%E5%B1%8F2019-12-09%E4%B8%8B%E5%8D%881.58.42.png)

### 模拟点击
但是其实对于写网页脚本的同学来说可能事情就变得很简单了，写个脚本就可以在这个网页上领喵币了；但是我在写辅助功能的时候就说过，模拟点击可以帮助我们做任何事情，配合上图象识别和屏幕截屏是万能的。

### 实现思路
可以看到这个界面上有7个按钮，对应不同的任务，而且完成任务后按钮会变成灰色的；第一个按钮是最简单的，点击签到就好了；第二个按钮分享好友实际上是没什么用的，反正我一般都完不成的，就不管了；其他的基本上都一样，都是点击后跳转到指定页面领取喵币，而且都是滑动界面12秒就领取成功。

那么我们记录这七个按钮的坐标，通过截屏去获取按钮当前的颜色，如果按钮颜色是灰色就跳过，是红色就代表可以领取，点击改点；然后在另一个界面进行模拟触摸上下滑动12秒，结束后点击返回，回到这个界面继续

其实还是会遇到一些特殊的任务，不是滑动点击的，和分享好友一样稍微复杂一点的，没关系，复杂的就那么一两个，我们在界面上可以设置跳过第几个按钮，跳过这个按钮，最后由我们自己去完成这个任务。感觉很合理呀，虽然可以花时间去做到完美，但是我就是想要快速领喵币而已，又不是把这个辅助做到完美，双十一一过就没用了呀。

除此以外，如何去触发这个辅助，因为辅助功能开启后很多是依靠界面改变触发的，但是我觉得这里不是很合适；就简单写一个悬浮窗，开启服务的时候开启悬浮窗，点击悬浮窗就开始运行我们的逻辑jin领喵币，再次点击就暂停。

## 具体编码
```java
private void start() {
        //获取当前屏幕截屏
        bitmap = ScreenRecordUtil.getInstance().getScreenShot();
        new Thread(() -> {
            //初始化颜色识别类
            LabColorLike labColorLike = new LabColorLike();
            //遍历这7个按钮
            for (int i = 0; i < yPoint.size(); i++) {
                //如果暂停就return
                if (pause) {
                    return;
                }
                //颜色为红色
                if (labColorLike.isLike(bitmap.getPixel(xPoint, yPoint.get(i)), red, 10)) {
                    //点击该按钮
                    clickOnScreen(xPoint, yPoint.get(i), 200, null);
                    //500ms的时间跳转到下一个界面（淘宝还是略卡）
                    SystemClock.sleep(500);
                    if (i == 0) {
                        //如果是签到就完成了
                        continue;
                    } else {
                        //先在界面停留3秒，等该界面加载完成
                        SystemClock.sleep(3000);
                        //签到页面滑动
                        for (int k = 0; k < 5; k++) {
                            //模拟手指上滑操作，界面往下滑，有时候下滑到指定地方才能领喵币
                            performScrollForward();
                            SystemClock.sleep(2000);
                        }
                        for (int k = 0; k < 3; k++) {
                            //模拟下滑
                            performScrollBackward();
                            SystemClock.sleep(1000);
                            //模拟上滑
                            performScrollForward();
                            SystemClock.sleep(1000);
                        }
                        SystemClock.sleep(1500);
                        //返回
                        performBackClick();
                        i--;
                    }
                    SystemClock.sleep(1000);
                    //进行截屏
                    bitmap = ScreenRecordUtil.getInstance().getScreenShot();
                }
            }
            pause = true;
        }).start();
    }
```
大概也就花了一个小时左右吧，主要是功能写的比较粗糙；这里只展示了领喵币的代码，里面有些封装的方法：开启录屏、截屏、颜色识别、模拟滑动、悬浮窗权限等等，具体可以看源码

## 实际效果
帮朋友们领领喵币肯定没问题，可以快速的把任务都做完，但是有个致命的弱点，就是只适配固定分辨率的手机，其他分辨率不支持，因为按钮的位置是写死的，所以我只能用自己手机帮别人领币，该项目适配的分辨率是1440x2960；

## 项目地址
原文地址：[淘宝双十一领喵币辅助](https://www.jianshu.com/p/c1cb5a140a00)
项目地址：[双十一领喵币辅助](https://github.com/tyhjh/ForHouse)




